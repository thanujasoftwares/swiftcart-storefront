<!DOCTYPE html>
<html lang="en">
  <%- include('shared/head',{siteattributes:siteattributes}) %>

  <body class="fade-down">
    <%- include('shared/topbar',{siteattributes:siteattributes}) %>
    <%- include('shared/searchbar',{navigation:navigation,siteattributes:siteattributes}) %>
    <%- include('shared/navbar',{navigation:navigation,siteattributes:siteattributes}) %>
    <%- include('components/breadcrumb',{navPath:navPath,siteattributes:siteattributes}) %>

    <!-- Main Content -->
    <div class="container m-t-3">
        <div class="row">
  
          <!-- Checkout Form -->
          <div class="col-md-9">
            <div class="title"><span>Checkout</span></div>
            <form>
              <input type="hidden" data-cart-attribute='cstype' value='g'>
              <div class="row">
                <div class="form-group col-sm-6">
                  <label for="firstNameInput">First Name (*)</label>
                  <input type="text" class="form-control" id="firstNameInput" placeholder="First Name" required data-cart-attribute='fname'>
                  
                </div>
                <div class="form-group col-sm-6">
                  <label for="lastNameInput">Last Name (*)</label>
                  <input type="text" class="form-control" id="lastNameInput" placeholder="Last Name" required data-cart-attribute='lname'>
                </div>
                <div class="form-group col-sm-6">
                  <label for="emailInput">Email Address (*)</label>
                  <input type="email" class="form-control" id="emailInput" placeholder="Email Address" required data-cart-attribute='eaddr'>
                </div>
                <div class="form-group col-sm-6">
                  <label for="phoneInput">Phone Number (*)</label>
                  <input type="text" class="form-control" id="phoneInput" placeholder="Phone Number" required data-cart-attribute='pno'>
                </div>
                <div class="form-group col-sm-12">
                  <label for="addressInput">Address (*)</label>
                  <input type="text" class="form-control" id="phoneInput" placeholder="Address Line 1" required data-cart-attribute='adrl1'>
                  <br />
                  <input type="text" class="form-control" id="phoneInput" placeholder="Address Line 2 (optional)" data-cart-attribute='adrl2'>
                </div>
                <div class="form-group col-sm-6">
                  <label for="cityInput">City (*)</label>
                  <input type="text" class="form-control" id="cityInput" placeholder="City" required data-cart-attribute='adrcty'>
                </div>
                <div class="form-group col-sm-6">
                  <label for="regionInput">Region / State (*)</label>
                  <select class="form-control selectpicker" id="regionInput" data-live-search="true" data-dropup-auto="false" data-cart-attribute='adrst'>
                    <option value=""> --- Please Select --- </option>
                    <% states.forEach(function(st){ %>
                      <option value='<%= st.key %>'><%= st.name %></option>
                    <% }) %>
                  </select>
                </div>
                <div class="form-group col-sm-6">
                  <label for="postInput">Post Code (*)</label>
                  <input type="text" class="form-control" id="postInput" placeholder="Post Code" required data-cart-attribute='adrpst'>
                </div>
                <div class="form-group col-sm-6">
                    <label for="postInput">Payment Type (*)</label>
                    <select class="form-control selectpicker" id="regionInput" data-live-search="true" data-dropup-auto="false" data-cart-attribute='paytype'>
                        <% paytypes.forEach(function(st){ %>
                          <option value='<%= st.key %>'><%= st.name %></option>
                        <% }) %>                      
                    </select>
                    </div>
                <!-- <div class="form-group col-sm-12">
                  <label for="notesInput">Notes</label>
                  <textarea class="form-control" rows="3" id="notesInput"></textarea>
                </div> -->
              </div>
              <div class="table-responsive">
                  <table class="table table-bordered table-cart">
                      <thead>
                        <tr>
                          <th>Product</th>
                          <th>Title</th>
                          <th>Size</th>
                          <th>Quantity</th>
                          <th>Unit price</th>
                          <th>SubTotal</th>
                        </tr>
                      </thead>
                      <tbody id="shop-chkout-table-rows">
                      </tbody>
                      <tr>
                          <td colspan="4" class="text-right">Sub total</td>
                          <td colspan="2"><b id="shop-cart-table-st">0.00</b></td>
                      </tr>                
                      <!-- <tr>
                          <td colspan="4" class="text-right">GST</td>
                          <td colspan="2"><b id="shop-cart-table-gst">0.00</b></td>
                      </tr>                
                      <tr>
                          <td colspan="4" class="text-right">Shipping Charges</td>
                          <td colspan="2"><b id="shop-cart-table-dc">0.00</b></td>
                      </tr>                 -->
                      <tr>
                          <td colspan="4" class="text-right">Total (including GST and Shipping charges )</td>
                          <td colspan="2"><b id="shop-cart-table-tt">0.00</b></td>
                      </tr>                
                    </table>
              </div>
              <nav aria-label="Checkout Next Navigation">
                <ul class="pager">
                  <li class="previous"><a href="/cart.html"><span aria-hidden="true">&larr;</span> Back to Shopping Cart</a></li>
                  <li class="next"><a href="javascript:checkout()">Confirm Order <span aria-hidden="true">&rarr;</span></a></li>
                </ul>
              </nav>
            </form>
          </div>
          <!-- End Checkout Form -->
        </div>  
    </div> 
    <%- include('shared/footer',{siteattributes:siteattributes}) %>
    <%- include('shared/scripts') %>
    <script type="text/javascript">
      $(document).ready(function(){
        var stotal=0;
        var gst = 0;
//        var gst=localStorage.getItem('gst') || '0.05';
        var ctotal=0.00;
        var dctotal = 0;
        for ( var i = 0, len = localStorage.length; i < len; ++i ) {
            key=localStorage.key( i );
            if(key.indexOf('#c-chk-') == 0){
                var {qty,img,url,name,price,sku,size} = JSON.parse(localStorage.getItem(key));
                var innerCartHTML='<tr id="c-chk-'+sku+'-'+size+'-tr"><td class="img-cart"><a href="'+url+'"><img class="img-thumbnail" src="'+img+'" alt="product"></a></td>';
                innerCartHTML +='<td><p><a href="'+url+'" class="d-block">'+name+'</a></p></td><td>'+size+'</td><td>'+qty+'</td><td class="unit">'+(price).toFixed(2)+'</td><td class="sub">'+(price*qty).toFixed(2)+'</td>';
                innerCartHTML +='<td class="action"><a href="javascript:removeItemFromCart(\'#c-chk-'+sku+'-'+size+'\');" class="text-danger" data-toggle="tooltip" data-placement="top" data-original-title="Remove"><i class="fa fa-trash-o"></i></a></td></tr>';
                $(innerCartHTML).appendTo('#shop-cart-table-rows');
                var innerCartHTML2='<tr id="c-chk-'+sku+'-'+size+'-tr"><td class="img-cart"><a href="'+url+'"><img class="img-thumbnail" src="'+img+'" alt="product"></a></td>';
                innerCartHTML2 +='<td><p><a href="'+url+'" class="d-block">'+name+'</a></p></td><td>'+size+'</td><td>'+qty+'</td><td class="unit">'+(price).toFixed(2)+'</td><td class="sub">'+(price*qty).toFixed(2)+'</td>';
                innerCartHTML2 +='</tr>';
                $(innerCartHTML2).appendTo('#shop-chkout-table-rows');
                
                stotal += (price*qty);
            }
        }
        ctotal = stotal + (stotal * gst);
        $('#shop-cart-table-st').text(stotal.toFixed(2));
//        $('#shop-cart-table-gst').text((stotal * gst).toFixed(2));
//        $('#shop-cart-table-dc').text(dctotal.toFixed(2));
        $('#shop-cart-table-tt').text(ctotal.toFixed(2));        
      })
    </script>

  </body>
</html>